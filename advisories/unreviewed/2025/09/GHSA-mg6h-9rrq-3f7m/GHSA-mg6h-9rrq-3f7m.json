{
  "schema_version": "1.4.0",
  "id": "GHSA-mg6h-9rrq-3f7m",
  "modified": "2025-09-05T18:31:26Z",
  "published": "2025-09-05T18:31:26Z",
  "aliases": [
    "CVE-2025-39674"
  ],
  "details": "In the Linux kernel, the following vulnerability has been resolved:\n\nscsi: ufs: ufs-qcom: Fix ESI null pointer dereference\n\nESI/MSI is a performance optimization feature that provides dedicated\ninterrupts per MCQ hardware queue. This is optional feature and UFS MCQ\nshould work with and without ESI feature.\n\nCommit e46a28cea29a (\"scsi: ufs: qcom: Remove the MSI descriptor abuse\")\nbrings a regression in ESI (Enhanced System Interrupt) configuration that\ncauses a null pointer dereference when Platform MSI allocation fails.\n\nThe issue occurs in when platform_device_msi_init_and_alloc_irqs() in\nufs_qcom_config_esi() fails (returns -EINVAL) but the current code uses\n__free() macro for automatic cleanup free MSI resources that were never\nsuccessfully allocated.\n\nUnable to handle kernel NULL pointer dereference at virtual\naddress 0000000000000008\n\n  Call trace:\n  mutex_lock+0xc/0x54 (P)\n  platform_device_msi_free_irqs_all+0x1c/0x40\n  ufs_qcom_config_esi+0x1d0/0x220 [ufs_qcom]\n  ufshcd_config_mcq+0x28/0x104\n  ufshcd_init+0xa3c/0xf40\n  ufshcd_pltfrm_init+0x504/0x7d4\n  ufs_qcom_probe+0x20/0x58 [ufs_qcom]\n\nFix by restructuring the ESI configuration to try MSI allocation first,\nbefore any other resource allocation and instead use explicit cleanup\ninstead of __free() macro to avoid cleanup of unallocated resources.\n\nTested on SM8750 platform with MCQ enabled, both with and without\nPlatform ESI support.",
  "severity": [],
  "affected": [],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-39674"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/6300d5c5438724c0876828da2f6e2c1a661871fc"
    },
    {
      "type": "WEB",
      "url": "https://git.kernel.org/stable/c/aaf17a35a59572c8b29372883619c3dbb0ebb50a"
    }
  ],
  "database_specific": {
    "cwe_ids": [],
    "severity": null,
    "github_reviewed": false,
    "github_reviewed_at": null,
    "nvd_published_at": "2025-09-05T18:15:43Z"
  }
}