{
  "schema_version": "1.4.0",
  "id": "GHSA-pw25-c82r-75mm",
  "modified": "2025-08-26T17:12:50Z",
  "published": "2025-08-25T21:48:01Z",
  "aliases": [
    "CVE-2025-57814"
  ],
  "summary": "request-filtering-agent SSRF Bypass via HTTPS Requests to 127.0.0.1",
  "details": "request-filtering-agent versions 1.x.x and earlier contain a vulnerability where HTTPS requests to 127.0.0.1 bypass IP address filtering, while HTTP requests are correctly blocked.\n\n**Impact:**\n\nVulnerable patterns (requests that should be blocked but are allowed):\n- https://127.0.0.1:443/api\n- https://127.0.0.1:8443/admin\n- Any HTTPS request using direct IP address `https://127.0.0.1`\n\nThis vulnerability primarily affects services using self-signed certificates on `127.0.0.1`.\n\n**Not affected (correctly blocked in all versions):**\n- http://127.0.0.1:80/api - HTTP requests are properly blocked\n- https://localhost:443/api - Domain-based requests trigger DNS lookup and are blocked\n- http://localhost:80/api - Domain-based HTTP requests are blocked\n- Requests to other private IPs like 192.168.x.x, 10.x.x.x, 172.16.x.x\n\nThis allows attackers to potentially access internal HTTPS services running on localhost, bypassing the library's SSRF protection. The vulnerability is particularly dangerous when the application accepts user-controlled URLs and internal services are only protected by network-level restrictions.\n\n## Fixed in 2.0.0\n\nThis vulnerability has been fixed in request-filtering-agent version 2.0.0. Users should upgrade to version 2.0.0 or later.\n\nRoot Cause:The HTTPS agent fails to validate direct IP addresses like `https://127.0.0.1` during TLS connection setup, allowing them to bypass the security filter.\n\nDetails: https://github.com/azu/request-filtering-agent-https127-test\n\nThanks Luca",
  "severity": [
    {
      "type": "CVSS_V4",
      "score": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:L/SI:L/SA:N/E:P"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "npm",
        "name": "request-filtering-agent"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "2.0.0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/azu/request-filtering-agent/security/advisories/GHSA-pw25-c82r-75mm"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-57814"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/azu/request-filtering-agent"
    },
    {
      "type": "WEB",
      "url": "https://github.com/azu/request-filtering-agent-https127-test"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-918"
    ],
    "severity": "MODERATE",
    "github_reviewed": true,
    "github_reviewed_at": "2025-08-25T21:48:01Z",
    "nvd_published_at": "2025-08-25T22:15:33Z"
  }
}